# åšå®¢åº”ç”¨æ›´æ–°æŒ‡å— / Blog Application Update Guide

## ğŸ”„ æ›´æ–°é€‰é¡¹ / Update Options

### 1. æœ¬åœ°Gitæ›´æ–° / Local Git Update

å¦‚æœæ‚¨ä½¿ç”¨Gitå…‹éš†äº†ä»“åº“ï¼Œå¯ä»¥ä½¿ç”¨æœ¬åœ°æ›´æ–°è„šæœ¬ï¼š

```bash
./update.sh
```

**åŠŸèƒ½ç‰¹æ€§ï¼š**
- âœ… è‡ªåŠ¨å¤‡ä»½ç°æœ‰æ•°æ®
- âœ… ä»Gitæ‹‰å–æœ€æ–°ä»£ç 
- âœ… ä¿ç•™ç”¨æˆ·é…ç½®
- âœ… é‡å»ºå¹¶å¯åŠ¨åº”ç”¨
- âœ… å¥åº·æ£€æŸ¥
- âœ… è‡ªåŠ¨æ¸…ç†

### 2. è¿œç¨‹Docker Hubæ›´æ–° / Remote Docker Hub Update

å¦‚æœæ‚¨æƒ³ä»Docker Hubè·å–æœ€æ–°ç‰ˆæœ¬ï¼š

```bash
# ä¸‹è½½å¹¶æ‰§è¡Œè¿œç¨‹æ›´æ–°è„šæœ¬
curl -sSL https://raw.githubusercontent.com/xuemian168/i18n_blog/main/update-from-hub.sh -o update-from-hub.sh && chmod +x update-from-hub.sh && ./update-from-hub.sh
```

**åŠŸèƒ½ç‰¹æ€§ï¼š**
- âœ… è‡ªåŠ¨å¤‡ä»½ç°æœ‰æ•°æ®
- âœ… ä¸‹è½½æœ€æ–°é…ç½®æ–‡ä»¶
- âœ… æ‹‰å–æœ€æ–°Dockeré•œåƒ
- âœ… ä¿ç•™ç”¨æˆ·é…ç½®
- âœ… å¯åŠ¨æ›´æ–°åçš„åº”ç”¨

## ğŸ”™ å›æ»šåŠŸèƒ½ / Rollback Feature

å¦‚æœæ›´æ–°åå‡ºç°é—®é¢˜ï¼Œå¯ä»¥å¿«é€Ÿå›æ»šåˆ°ä¹‹å‰çš„ç‰ˆæœ¬ï¼š

```bash
./rollback.sh <backup_timestamp>
```

ä¾‹å¦‚ï¼š
```bash
./rollback.sh 20250727_143052
```

## ğŸ“‹ æ›´æ–°å‰å‡†å¤‡ / Pre-Update Checklist

1. **å¤‡ä»½é‡è¦æ•°æ®** / Backup Important Data
   - è„šæœ¬ä¼šè‡ªåŠ¨å¤‡ä»½ï¼Œä½†å»ºè®®æ‰‹åŠ¨å¤‡ä»½é‡è¦å†…å®¹

2. **æ£€æŸ¥ç³»ç»Ÿèµ„æº** / Check System Resources
   - ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´
   - ç¡®ä¿Dockeræ­£åœ¨è¿è¡Œ

3. **è®°å½•å½“å‰é…ç½®** / Record Current Configuration
   - è®°å½•å½“å‰çš„ç¯å¢ƒå˜é‡è®¾ç½®
   - è®°å½•ä»»ä½•è‡ªå®šä¹‰é…ç½®

## ğŸ›  æ›´æ–°è¿‡ç¨‹ / Update Process

### è‡ªåŠ¨æ‰§è¡Œçš„æ­¥éª¤ï¼š

1. **æ•°æ®å¤‡ä»½** / Data Backup
   - æ•°æ®åº“å¤‡ä»½
   - ä¸Šä¼ æ–‡ä»¶å¤‡ä»½
   - é…ç½®æ–‡ä»¶å¤‡ä»½

2. **ä»£ç æ›´æ–°** / Code Update
   - Gitæ‹‰å–æœ€æ–°ä»£ç ï¼ˆæœ¬åœ°æ›´æ–°ï¼‰
   - ä¸‹è½½æœ€æ–°Dockeré•œåƒï¼ˆè¿œç¨‹æ›´æ–°ï¼‰

3. **æœåŠ¡é‡å¯** / Service Restart
   - åœæ­¢æ—§æœåŠ¡
   - æ„å»ºæ–°é•œåƒ
   - å¯åŠ¨æ–°æœåŠ¡

4. **å¥åº·æ£€æŸ¥** / Health Check
   - éªŒè¯æœåŠ¡çŠ¶æ€
   - æµ‹è¯•APIè¿æ¥
   - ç¡®è®¤åº”ç”¨æ­£å¸¸è¿è¡Œ

## ğŸ—‚ å¤‡ä»½ç®¡ç† / Backup Management

å¤‡ä»½æ–‡ä»¶å­˜å‚¨åœ¨ `./backups/` ç›®å½•ä¸‹ï¼ŒæŒ‰æ—¶é—´æˆ³ç»„ç»‡ï¼š

```
backups/
â”œâ”€â”€ 20250727_143052/    # æ›´æ–°å‰è‡ªåŠ¨å¤‡ä»½
â”œâ”€â”€ 20240728_091234/    # å¦ä¸€æ¬¡æ›´æ–°çš„å¤‡ä»½
â””â”€â”€ pre_rollback_*/     # å›æ»šå‰çš„å¤‡ä»½
```

### å¤‡ä»½å†…å®¹åŒ…æ‹¬ï¼š
- æ•°æ®åº“æ–‡ä»¶
- ä¸Šä¼ çš„åª’ä½“æ–‡ä»¶
- ç¯å¢ƒé…ç½®æ–‡ä»¶
- Docker Composeè¦†ç›–æ–‡ä»¶

## âš ï¸ æ³¨æ„äº‹é¡¹ / Important Notes

1. **ç½‘ç»œè¿æ¥** / Network Connection
   - ç¡®ä¿ç½‘ç»œè¿æ¥ç¨³å®š
   - è¿œç¨‹æ›´æ–°éœ€è¦è®¿é—®Docker Hub

2. **æƒé™è¦æ±‚** / Permission Requirements
   - è„šæœ¬éœ€è¦Dockeræ“ä½œæƒé™
   - æ–‡ä»¶ç³»ç»Ÿå†™å…¥æƒé™

3. **æœåŠ¡ä¸­æ–­** / Service Interruption
   - æ›´æ–°è¿‡ç¨‹ä¸­æœåŠ¡ä¼šçŸ­æš‚ä¸­æ–­
   - å»ºè®®åœ¨ä½å³°æ—¶æ®µè¿›è¡Œæ›´æ–°

4. **é…ç½®ä¿ç•™** / Configuration Preservation
   - `.env` æ–‡ä»¶ä¼šè¢«ä¿ç•™
   - è‡ªå®šä¹‰Docker Composeè®¾ç½®ä¼šè¢«ä¿ç•™

## ğŸ†˜ æ•…éšœæ’é™¤ / Troubleshooting

### æ›´æ–°å¤±è´¥ / Update Failed

```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker-compose logs -f

# é‡æ–°å¯åŠ¨æœåŠ¡
docker-compose restart

# å¦‚æœé—®é¢˜ä¸¥é‡ï¼Œå›æ»šåˆ°ä¹‹å‰ç‰ˆæœ¬
./rollback.sh <backup_timestamp>
```

### æœåŠ¡æ— æ³•å¯åŠ¨ / Service Won't Start

```bash
# æ£€æŸ¥DockerçŠ¶æ€
docker info

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep :3000
netstat -tlnp | grep :8080

# å¼ºåˆ¶é‡æ–°æ„å»º
docker-compose up --build --force-recreate
```

### æ•°æ®ä¸¢å¤± / Data Loss

```bash
# æ£€æŸ¥å¤‡ä»½
ls -la ./backups/

# æ¢å¤æœ€æ–°å¤‡ä»½
./rollback.sh <latest_backup_timestamp>
```

## ğŸ“ è·å–å¸®åŠ© / Getting Help

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š

1. æŸ¥çœ‹åº”ç”¨æ—¥å¿—ï¼š`docker-compose logs -f`
2. æ£€æŸ¥å¤‡ä»½æ–‡ä»¶ï¼š`ls -la ./backups/`
3. åœ¨GitHubä¸Šæäº¤Issue
4. æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£

## ğŸ”„ å®šæœŸæ›´æ–°å»ºè®® / Regular Update Recommendations

- å»ºè®®æ¯æœˆæ£€æŸ¥ä¸€æ¬¡æ›´æ–°
- é‡è¦å®‰å…¨æ›´æ–°åº”åŠæ—¶åº”ç”¨
- åœ¨æµ‹è¯•ç¯å¢ƒä¸­å…ˆéªŒè¯æ›´æ–°
- ä¿æŒè‡³å°‘3ä¸ªæœ€æ–°å¤‡ä»½

---

**æ³¨æ„ï¼š** æ›´æ–°è„šæœ¬ä¼šå°½åŠ›ä¿æŠ¤æ‚¨çš„æ•°æ®ï¼Œä½†å»ºè®®åœ¨é‡è¦æ›´æ–°å‰æ‰‹åŠ¨å¤‡ä»½å…³é”®æ•°æ®ã€‚